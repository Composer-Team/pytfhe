<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-submodules/pytfhe-frontend/runner" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Boolean TFHE Program Runner | The PyTFHE-OSS Framework</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://composer-team.github.io/pytfhe/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://composer-team.github.io/pytfhe/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://composer-team.github.io/pytfhe/docs/submodules/pytfhe-frontend/runner"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Boolean TFHE Program Runner | The PyTFHE-OSS Framework"><meta data-rh="true" name="description" content="The runner module provides the core execution engines for running FHE circuits. It supports multiple execution backends including CPU (serial and Ray distributed), GPU (CUDA), and various FHE libraries (pyTFHE, cuFHE). The module handles scheduling, batching, and parallel execution of FHE operations."><meta data-rh="true" property="og:description" content="The runner module provides the core execution engines for running FHE circuits. It supports multiple execution backends including CPU (serial and Ray distributed), GPU (CUDA), and various FHE libraries (pyTFHE, cuFHE). The module handles scheduling, batching, and parallel execution of FHE operations."><link data-rh="true" rel="icon" href="/pytfhe/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://composer-team.github.io/pytfhe/docs/submodules/pytfhe-frontend/runner"><link data-rh="true" rel="alternate" href="https://composer-team.github.io/pytfhe/docs/submodules/pytfhe-frontend/runner" hreflang="en"><link data-rh="true" rel="alternate" href="https://composer-team.github.io/pytfhe/docs/submodules/pytfhe-frontend/runner" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Submodules","item":"https://composer-team.github.io/pytfhe/docs/category/submodules"},{"@type":"ListItem","position":2,"name":"PyTFHE-Frontend","item":"https://composer-team.github.io/pytfhe/docs/category/pytfhe-frontend"},{"@type":"ListItem","position":3,"name":"Boolean TFHE Program Runner","item":"https://composer-team.github.io/pytfhe/docs/submodules/pytfhe-frontend/runner"}]}</script><link rel="alternate" type="application/rss+xml" href="/pytfhe/blog/rss.xml" title="The PyTFHE-OSS Framework RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/pytfhe/blog/atom.xml" title="The PyTFHE-OSS Framework Atom Feed"><link rel="stylesheet" href="/pytfhe/assets/css/styles.a7778f11.css">
<script src="/pytfhe/assets/js/runtime~main.0e201737.js" defer="defer"></script>
<script src="/pytfhe/assets/js/main.7fbfeded.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/pytfhe/img/pytfhe-icon-small.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">PyTFHE-OSS docs just got released!</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/pytfhe/"><div class="navbar__logo"><img src="/pytfhe/img/pytfhe-icon-small.png" alt="PyTFHE" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/pytfhe/img/pytfhe-icon-small.png" alt="PyTFHE" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">PyTFHE-OSS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pytfhe/docs/intro">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pytfhe/docs/intro">PyTFHE Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/pytfhe/docs/category/submodules">Submodules</a><button aria-label="Collapse sidebar category &#x27;Submodules&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pytfhe/docs/submodules/pytfhe-cpu">PyTFHE-CPU</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pytfhe/docs/submodules/aiger-tools">AIGER Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pytfhe/docs/submodules/pytfhe-cuda">PyTFHE-CUDA</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/pytfhe/docs/category/pytfhe-rs">PyTFHE-rs</a><button aria-label="Expand sidebar category &#x27;PyTFHE-rs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/pytfhe/docs/category/pytfhe-frontend">PyTFHE-Frontend</a><button aria-label="Collapse sidebar category &#x27;PyTFHE-Frontend&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/pytfhe/docs/submodules/pytfhe-frontend/overview">PyTFHE-Frontend Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/pytfhe/docs/submodules/pytfhe-frontend/xls-bridge">XLS IR to TASM Converter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/pytfhe/docs/submodules/pytfhe-frontend/asm-tools">TFHE Assembly (TASM) Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pytfhe/docs/submodules/pytfhe-frontend/runner">Boolean TFHE Program Runner</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/pytfhe/docs/submodules/pytfhe-frontend/benchmark">Benchmark Submodule</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/pytfhe/docs/category/chiseltorch">ChiselTorch</a><button aria-label="Expand sidebar category &#x27;ChiselTorch&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/pytfhe/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/pytfhe/docs/category/submodules"><span>Submodules</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/pytfhe/docs/category/pytfhe-frontend"><span>PyTFHE-Frontend</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Boolean TFHE Program Runner</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Boolean TFHE Program Runner</h1></header>
<p>The <code>runner</code> module provides the core execution engines for running FHE circuits. It supports multiple execution backends including CPU (serial and Ray distributed), GPU (CUDA), and various FHE libraries (pyTFHE, cuFHE). The module handles scheduling, batching, and parallel execution of FHE operations.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-components">Core Components<a href="#core-components" class="hash-link" aria-label="Direct link to Core Components" title="Direct link to Core Components">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="main-execution-engines">Main Execution Engines<a href="#main-execution-engines" class="hash-link" aria-label="Direct link to Main Execution Engines" title="Direct link to Main Execution Engines">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cpu-execution-mainpy">CPU Execution (<code>main.py</code>)<a href="#cpu-execution-mainpy" class="hash-link" aria-label="Direct link to cpu-execution-mainpy" title="Direct link to cpu-execution-mainpy">​</a></h4>
<p>Main entry point for CPU-based FHE circuit execution with Ray distributed computing.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Command-line interface for circuit execution</li>
<li>Ray cluster integration for distributed computing</li>
<li>LUT-based circuit execution</li>
<li>Support for both serial and parallel modes</li>
</ul>
<p><strong>Usage:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python -m pyTNFS.runner.main -i circuit.lut -c 8 --ray ray://cluster:10001</span><br></span></code></pre></div></div>
<p><strong>Workflow:</strong></p>
<ol>
<li>Load and decompress LUT binary circuit</li>
<li>Initialize FHE parameters and keys</li>
<li>Create input ciphertexts</li>
<li>Schedule operations using greedy scheduler</li>
<li>Execute using Ray workers or serial execution</li>
<li>Collect and decrypt outputs</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="gpu-execution-main_gpupy">GPU Execution (<code>main_gpu.py</code>)<a href="#gpu-execution-main_gpupy" class="hash-link" aria-label="Direct link to gpu-execution-main_gpupy" title="Direct link to gpu-execution-main_gpupy">​</a></h4>
<p>CUDA GPU-accelerated execution using pyTFHEGPU backend.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>CUDA acceleration for FHE operations</li>
<li>Batch processing with configurable batch sizes</li>
<li>Megabatch support for large circuits</li>
<li>GPU memory management</li>
</ul>
<p><strong>Key Function:</strong></p>
<ul>
<li><code>gpu_execute(filename: str, batchsize: int, megabatch_size: int)</code>
<ul>
<li>Loads circuit from file (supports gzip compression)</li>
<li>Schedules operations using LUT greedy scheduler</li>
<li>Executes in batches on GPU</li>
<li>Manages GPU memory and timing</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ray-based-distributed-computing">Ray-Based Distributed Computing<a href="#ray-based-distributed-computing" class="hash-link" aria-label="Direct link to Ray-Based Distributed Computing" title="Direct link to Ray-Based Distributed Computing">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="worker-pool-ray_workerpy">Worker Pool (<code>ray_worker.py</code>)<a href="#worker-pool-ray_workerpy" class="hash-link" aria-label="Direct link to worker-pool-ray_workerpy" title="Direct link to worker-pool-ray_workerpy">​</a></h4>
<p>Distributed worker management for parallel FHE execution.</p>
<p><strong>Key Classes:</strong></p>
<ul>
<li><code>TFHEWorker</code> - Remote Ray actor for FHE operations</li>
<li><code>TFHETqdm</code> - Distributed progress tracking</li>
<li><code>WorkerPool</code> - Manages pool of TFHEWorker instances</li>
</ul>
<p><strong>TFHEWorker Operations:</strong></p>
<ul>
<li><code>and_invert(a, a_ivt, b, b_ivt)</code> - AND with optional input inversion</li>
<li><code>lut2(lut, a, b)</code> - 2-input LUT evaluation</li>
<li><code>lut1(lut, a)</code> - 1-input LUT evaluation</li>
<li><code>copy_ct(ct)</code> - Ciphertext copying</li>
</ul>
<p><strong>WorkerPool Features:</strong></p>
<ul>
<li>Automatic load balancing across workers</li>
<li>Progress tracking with tqdm</li>
<li>Configurable worker count</li>
<li>Efficient task distribution</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="circuit-execution-runners">Circuit Execution Runners<a href="#circuit-execution-runners" class="hash-link" aria-label="Direct link to Circuit Execution Runners" title="Direct link to Circuit Execution Runners">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="lut-based-runner-tnfs_lut2_runnerpy">LUT-Based Runner (<code>tnfs_lut2_runner.py</code>)<a href="#lut-based-runner-tnfs_lut2_runnerpy" class="hash-link" aria-label="Direct link to lut-based-runner-tnfs_lut2_runnerpy" title="Direct link to lut-based-runner-tnfs_lut2_runnerpy">​</a></h4>
<p>Executes circuits using Look-Up Table (LUT) representation.</p>
<p><strong>Key Functions:</strong></p>
<ul>
<li>
<p><code>tnfs_lut2_runner(schedule, input_state, output, bk, num_workers=8)</code></p>
<ul>
<li>Distributed execution using Ray workers</li>
<li>Handles 2-input LUT operations</li>
<li>Manages circuit state throughout execution</li>
</ul>
</li>
<li>
<p><code>tnfs_lut2_runner_serial(schedule, input_state, output, bk, num_workers=1)</code></p>
<ul>
<li>Serial execution for single-threaded mode</li>
<li>Same functionality as distributed version</li>
<li>Useful for debugging and small circuits</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tfhe-runners-tfhe_py">TFHE Runners (<code>tfhe_*.py</code>)<a href="#tfhe-runners-tfhe_py" class="hash-link" aria-label="Direct link to tfhe-runners-tfhe_py" title="Direct link to tfhe-runners-tfhe_py">​</a></h4>
<p>Various TFHE execution strategies:</p>
<ul>
<li><strong><code>tfhe_serial.py</code></strong> - Single-threaded TFHE execution</li>
<li><strong><code>tfhe_ray.py</code></strong> - Ray distributed TFHE execution</li>
<li><strong><code>tfhe_ray_schedule.py</code></strong> - Advanced Ray scheduling strategies</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-fhe-backends">Alternative FHE Backends<a href="#alternative-fhe-backends" class="hash-link" aria-label="Direct link to Alternative FHE Backends" title="Direct link to Alternative FHE Backends">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cufhe-integration-cufhe_runnerpy-cufhe_benchmark_driverpy">cuFHE Integration (<code>cuFHE_runner.py</code>, <code>cufhe_benchmark_driver.py</code>)<a href="#cufhe-integration-cufhe_runnerpy-cufhe_benchmark_driverpy" class="hash-link" aria-label="Direct link to cufhe-integration-cufhe_runnerpy-cufhe_benchmark_driverpy" title="Direct link to cufhe-integration-cufhe_runnerpy-cufhe_benchmark_driverpy">​</a></h4>
<p>Integration with cuFHE library for GPU acceleration.</p>
<ul>
<li>Supports cuFHE GPU kernels</li>
<li>Benchmark drivers for performance measurement</li>
<li>Alternative to pyTFHEGPU backend</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="libfhe-support-libfhepy">LibFHE Support (<code>libfhe.py</code>)<a href="#libfhe-support-libfhepy" class="hash-link" aria-label="Direct link to libfhe-support-libfhepy" title="Direct link to libfhe-support-libfhepy">​</a></h4>
<p>Generic FHE library integration interface.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="benchmarking-and-profiling">Benchmarking and Profiling<a href="#benchmarking-and-profiling" class="hash-link" aria-label="Direct link to Benchmarking and Profiling" title="Direct link to Benchmarking and Profiling">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="gpu-benchmarking-gpu_benchmark_driverpy">GPU Benchmarking (<code>gpu_benchmark_driver.py</code>)<a href="#gpu-benchmarking-gpu_benchmark_driverpy" class="hash-link" aria-label="Direct link to gpu-benchmarking-gpu_benchmark_driverpy" title="Direct link to gpu-benchmarking-gpu_benchmark_driverpy">​</a></h4>
<p>Performance measurement for GPU execution:</p>
<ul>
<li>Throughput measurement</li>
<li>Latency profiling</li>
<li>Memory usage tracking</li>
<li>Batch size optimization</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sweep-testing-sweeppy">Sweep Testing (<code>sweep.py</code>)<a href="#sweep-testing-sweeppy" class="hash-link" aria-label="Direct link to sweep-testing-sweeppy" title="Direct link to sweep-testing-sweeppy">​</a></h4>
<p>Parameter sweep testing for optimization:</p>
<ul>
<li>Batch size sweeps</li>
<li>Worker count optimization</li>
<li>Performance parameter tuning</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="execution-modes">Execution Modes<a href="#execution-modes" class="hash-link" aria-label="Direct link to Execution Modes" title="Direct link to Execution Modes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="serial-execution">Serial Execution<a href="#serial-execution" class="hash-link" aria-label="Direct link to Serial Execution" title="Direct link to Serial Execution">​</a></h3>
<ul>
<li>Single-threaded execution on CPU</li>
<li>Good for debugging and small circuits</li>
<li>Minimal resource requirements</li>
<li>Command: <code>python -m pyTNFS.runner.main -i circuit.lut -c 1</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ray-distributed-execution">Ray Distributed Execution<a href="#ray-distributed-execution" class="hash-link" aria-label="Direct link to Ray Distributed Execution" title="Direct link to Ray Distributed Execution">​</a></h3>
<ul>
<li>Multi-worker parallel execution on CPU cluster</li>
<li>Scalable across multiple machines</li>
<li>Automatic load balancing</li>
<li>Command: <code>python -m pyTNFS.runner.main -i circuit.lut -c 16 --ray ray://head:10001</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpu-execution">GPU Execution<a href="#gpu-execution" class="hash-link" aria-label="Direct link to GPU Execution" title="Direct link to GPU Execution">​</a></h3>
<ul>
<li>CUDA-accelerated execution</li>
<li>High throughput for large circuits</li>
<li>Requires NVIDIA GPU with CUDA support</li>
<li>Command: <code>python -m pyTNFS.runner.main_gpu circuit.lut 1024 102400</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="circuit-format-support">Circuit Format Support<a href="#circuit-format-support" class="hash-link" aria-label="Direct link to Circuit Format Support" title="Direct link to Circuit Format Support">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lut-binary-format">LUT Binary Format<a href="#lut-binary-format" class="hash-link" aria-label="Direct link to LUT Binary Format" title="Direct link to LUT Binary Format">​</a></h3>
<ul>
<li>Look-Up Table representation of circuits</li>
<li>Efficient 2-input gate operations</li>
<li>Compressed storage with gzip support</li>
<li>Optimized for parallel execution</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tnfs-binary-format">TNFS Binary Format<a href="#tnfs-binary-format" class="hash-link" aria-label="Direct link to TNFS Binary Format" title="Direct link to TNFS Binary Format">​</a></h3>
<ul>
<li>Threshold Network File System format</li>
<li>Direct circuit representation</li>
<li>Support for various gate types</li>
<li>Compatible with scheduling algorithms</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-optimization">Performance Optimization<a href="#performance-optimization" class="hash-link" aria-label="Direct link to Performance Optimization" title="Direct link to Performance Optimization">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="batching-strategies">Batching Strategies<a href="#batching-strategies" class="hash-link" aria-label="Direct link to Batching Strategies" title="Direct link to Batching Strategies">​</a></h3>
<ul>
<li><strong>Batch Size</strong>: Controls memory vs. parallelism trade-off</li>
<li><strong>Megabatches</strong>: Handle very large circuits by subdividing</li>
<li><strong>Dynamic Batching</strong>: Adjust batch sizes based on circuit characteristics</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-management">Memory Management<a href="#memory-management" class="hash-link" aria-label="Direct link to Memory Management" title="Direct link to Memory Management">​</a></h3>
<ul>
<li>Ray object store for distributed ciphertext sharing</li>
<li>GPU memory allocation and deallocation</li>
<li>Garbage collection integration for large circuits</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scheduling-integration">Scheduling Integration<a href="#scheduling-integration" class="hash-link" aria-label="Direct link to Scheduling Integration" title="Direct link to Scheduling Integration">​</a></h3>
<ul>
<li>Uses <code>tnfs</code> module scheduling algorithms</li>
<li>Greedy scheduling for LUT-based circuits</li>
<li>Optimization for both serial and parallel execution</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-examples">Usage Examples<a href="#usage-examples" class="hash-link" aria-label="Direct link to Usage Examples" title="Direct link to Usage Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-circuit-execution">Basic Circuit Execution<a href="#basic-circuit-execution" class="hash-link" aria-label="Direct link to Basic Circuit Execution" title="Direct link to Basic Circuit Execution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pyTNFS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">runner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">main </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pyTFHE </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Setup FHE parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">params </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">new_default_gate_bootstrapping_parameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sk </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">new_random_gate_bootstrapping_secret_keyset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Load and execute circuit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;circuit.lut&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rb&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    binary_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute with 8 workers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> execute_circuit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binary_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_workers</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpu-execution-1">GPU Execution<a href="#gpu-execution-1" class="hash-link" aria-label="Direct link to GPU Execution" title="Direct link to GPU Execution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pyTNFS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">runner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">main_gpu </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> gpu_execute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute on GPU with specified batch sizes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpu_execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;circuit.lut.gz&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batchsize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> megabatch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">102400</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ray-cluster-setup">Ray Cluster Setup<a href="#ray-cluster-setup" class="hash-link" aria-label="Direct link to Ray Cluster Setup" title="Direct link to Ray Cluster Setup">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pyTNFS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">runner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tnfs_lut2_runner </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tnfs_lut2_runner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Connect to Ray cluster</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ray</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;ray://cluster-head:10001&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute distributed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tnfs_lut2_runner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">schedule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> outputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_workers</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/submodules/pytfhe-frontend/runner.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/pytfhe/docs/submodules/pytfhe-frontend/asm-tools"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TFHE Assembly (TASM) Tools</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pytfhe/docs/submodules/pytfhe-frontend/benchmark"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Benchmark Submodule</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#core-components" class="table-of-contents__link toc-highlight">Core Components</a><ul><li><a href="#main-execution-engines" class="table-of-contents__link toc-highlight">Main Execution Engines</a></li><li><a href="#ray-based-distributed-computing" class="table-of-contents__link toc-highlight">Ray-Based Distributed Computing</a></li><li><a href="#circuit-execution-runners" class="table-of-contents__link toc-highlight">Circuit Execution Runners</a></li><li><a href="#alternative-fhe-backends" class="table-of-contents__link toc-highlight">Alternative FHE Backends</a></li><li><a href="#benchmarking-and-profiling" class="table-of-contents__link toc-highlight">Benchmarking and Profiling</a></li></ul></li><li><a href="#execution-modes" class="table-of-contents__link toc-highlight">Execution Modes</a><ul><li><a href="#serial-execution" class="table-of-contents__link toc-highlight">Serial Execution</a></li><li><a href="#ray-distributed-execution" class="table-of-contents__link toc-highlight">Ray Distributed Execution</a></li><li><a href="#gpu-execution" class="table-of-contents__link toc-highlight">GPU Execution</a></li></ul></li><li><a href="#circuit-format-support" class="table-of-contents__link toc-highlight">Circuit Format Support</a><ul><li><a href="#lut-binary-format" class="table-of-contents__link toc-highlight">LUT Binary Format</a></li><li><a href="#tnfs-binary-format" class="table-of-contents__link toc-highlight">TNFS Binary Format</a></li></ul></li><li><a href="#performance-optimization" class="table-of-contents__link toc-highlight">Performance Optimization</a><ul><li><a href="#batching-strategies" class="table-of-contents__link toc-highlight">Batching Strategies</a></li><li><a href="#memory-management" class="table-of-contents__link toc-highlight">Memory Management</a></li><li><a href="#scheduling-integration" class="table-of-contents__link toc-highlight">Scheduling Integration</a></li></ul></li><li><a href="#usage-examples" class="table-of-contents__link toc-highlight">Usage Examples</a><ul><li><a href="#basic-circuit-execution" class="table-of-contents__link toc-highlight">Basic Circuit Execution</a></li><li><a href="#gpu-execution-1" class="table-of-contents__link toc-highlight">GPU Execution</a></li><li><a href="#ray-cluster-setup" class="table-of-contents__link toc-highlight">Ray Cluster Setup</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pytfhe/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pytfhe/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 APEX Lab at Duke University. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>